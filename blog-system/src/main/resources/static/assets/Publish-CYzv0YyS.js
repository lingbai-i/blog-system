import{d as me,af as ve,m as ie,W as ge,r as g,p as le,n as L,aB as pe,b as se,ag as C,c as T,o as f,a as i,G as U,P as c,H as v,L as S,J as Y,u as oe,M as O,D as de,O as ee,a6 as te,aw as fe}from"./vendor-qcSz3H5x.js";import{z as u,q as he,v as ye,B as be,A as _e}from"./elementPlus-Cz6C--fH.js";import{a as H}from"./index-xsH4HHeE.js";import{Q as ne,D as ke,_ as ce,M as we,T as qe}from"./index-CbgkKY63.js";import{H as re}from"./index-CTYSh0L0.js";/*!
 * VueQuill @vueup/vue-quill v1.2.0
 * https://vueup.github.io/vue-quill/
 * 
 * Includes quill v1.3.7
 * https://quilljs.com/
 * 
 * Copyright (c) 2023 Ahmad Luthfi Masruri
 * Released under the MIT license
 * Date: 2023-05-12T08:44:03.742Z
 */const ue={essential:[[{header:[1,2,3,4,5,6,!1]}],["bold","italic","underline"],[{list:"ordered"},{list:"bullet"},{align:[]}],["blockquote","code-block","link"],[{color:[]},"clean"]],minimal:[[{header:1},{header:2}],["bold","italic","underline"],[{list:"ordered"},{list:"bullet"},{align:[]}]],full:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["link","video","image"],["clean"]]},Se=me({name:"QuillEditor",inheritAttrs:!1,props:{content:{type:[String,Object]},contentType:{type:String,default:"delta",validator:s=>["delta","html","text"].includes(s)},enable:{type:Boolean,default:!0},readOnly:{type:Boolean,default:!1},placeholder:{type:String,required:!1},theme:{type:String,default:"snow",validator:s=>["snow","bubble",""].includes(s)},toolbar:{type:[String,Array,Object],required:!1,validator:s=>typeof s=="string"&&s!==""?s.charAt(0)==="#"?!0:Object.keys(ue).indexOf(s)!==-1:!0},modules:{type:Object,required:!1},options:{type:Object,required:!1},globalOptions:{type:Object,required:!1}},emits:["textChange","selectionChange","editorChange","update:content","focus","blur","ready"],setup:(s,k)=>{ie(()=>{m()}),ge(()=>{t=null});let t,p;const h=g(),m=()=>{var e;if(h.value){if(p=$(),s.modules)if(Array.isArray(s.modules))for(const l of s.modules)ne.register(`modules/${l.name}`,l.module);else ne.register(`modules/${s.modules.name}`,s.modules.module);t=new ne(h.value,p),B(s.content),t.on("text-change",D),t.on("selection-change",M),t.on("editor-change",z),s.theme!=="bubble"&&h.value.classList.remove("ql-bubble"),s.theme!=="snow"&&h.value.classList.remove("ql-snow"),(e=t.getModule("toolbar"))===null||e===void 0||e.container.addEventListener("mousedown",l=>{l.preventDefault()}),k.emit("ready",t)}},$=()=>{const e={};if(s.theme!==""&&(e.theme=s.theme),s.readOnly&&(e.readOnly=s.readOnly),s.placeholder&&(e.placeholder=s.placeholder),s.toolbar&&s.toolbar!==""&&(e.modules={toolbar:(()=>{if(typeof s.toolbar=="object")return s.toolbar;if(typeof s.toolbar=="string")return s.toolbar.charAt(0)==="#"?s.toolbar:ue[s.toolbar]})()}),s.modules){const l=(()=>{var a,o;const n={};if(Array.isArray(s.modules))for(const d of s.modules)n[d.name]=(a=d.options)!==null&&a!==void 0?a:{};else n[s.modules.name]=(o=s.modules.options)!==null&&o!==void 0?o:{};return n})();e.modules=Object.assign({},e.modules,l)}return Object.assign({},s.globalOptions,s.options,e)},q=e=>typeof e=="object"&&e?e.slice():e,w=e=>Object.values(e.ops).some(l=>!l.retain||Object.keys(l).length!==1);let y;const V=e=>{if(typeof y==typeof e){if(e===y)return!0;if(typeof e=="object"&&e&&typeof y=="object"&&y)return!w(y.diff(e))}return!1},D=(e,l,a)=>{y=q(N()),V(s.content)||k.emit("update:content",y),k.emit("textChange",{delta:e,oldContents:l,source:a})},j=g(),M=(e,l,a)=>{j.value=!!(t!=null&&t.hasFocus()),k.emit("selectionChange",{range:e,oldRange:l,source:a})};le(j,e=>{e?k.emit("focus",h):k.emit("blur",h)});const z=(...e)=>{e[0]==="text-change"&&k.emit("editorChange",{name:e[0],delta:e[1],oldContents:e[2],source:e[3]}),e[0]==="selection-change"&&k.emit("editorChange",{name:e[0],range:e[1],oldRange:e[2],source:e[3]})},G=()=>h.value,K=()=>{var e;return(e=t==null?void 0:t.getModule("toolbar"))===null||e===void 0?void 0:e.container},J=()=>{if(t)return t;throw`The quill editor hasn't been instantiated yet,
                  make sure to call this method when the editor ready
                  or use v-on:ready="onReady(quill)" event instead.`},N=(e,l)=>s.contentType==="html"?E():s.contentType==="text"?W(e,l):t==null?void 0:t.getContents(e,l),B=(e,l="api")=>{const a=e||(s.contentType==="delta"?new ke:"");s.contentType==="html"?R(a):s.contentType==="text"?Q(a,l):t==null||t.setContents(a,l),y=q(a)},W=(e,l)=>{var a;return(a=t==null?void 0:t.getText(e,l))!==null&&a!==void 0?a:""},Q=(e,l="api")=>{t==null||t.setText(e,l)},E=()=>{var e;return(e=t==null?void 0:t.root.innerHTML)!==null&&e!==void 0?e:""},R=e=>{t&&(t.root.innerHTML=e)},P=(e,l="api")=>{const a=t==null?void 0:t.clipboard.convert(e);a&&(t==null||t.setContents(a,l))},F=()=>{t==null||t.focus()},X=()=>{L(()=>{var e;!k.slots.toolbar&&t&&((e=t.getModule("toolbar"))===null||e===void 0||e.container.remove()),m()})};return le(()=>s.content,e=>{if(!t||!e||V(e))return;const l=t.getSelection();l&&L(()=>t==null?void 0:t.setSelection(l)),B(e)},{deep:!0}),le(()=>s.enable,e=>{t&&t.enable(e)}),{editor:h,getEditor:G,getToolbar:K,getQuill:J,getContents:N,setContents:B,getHTML:E,setHTML:R,pasteHTML:P,focus:F,getText:W,setText:Q,reinit:X}},render(){var s,k;return[(k=(s=this.$slots).toolbar)===null||k===void 0?void 0:k.call(s),ve("div",{ref:"editor",...this.$attrs})]}}),Te={class:"rich-text-editor"},Ce={class:"editor-toolbar"},xe={class:"mode-switch"},Ve={class:"toolbar-actions"},Ae={key:1,class:"markdown-editor-container"},Ie={class:"markdown-input"},$e={key:0,class:"markdown-preview"},Me=["innerHTML"],Oe={__name:"RichTextEditor",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"å¼€å§‹å†™ä½œå§..."},height:{type:String,default:"400px"}},emits:["update:modelValue","image-uploaded"],setup(s,{expose:k,emit:t}){pe(o=>({"3d707344":s.height}));const p=s,h=t,m=g(p.modelValue),$=g(null),q=g("rich"),w=g(""),y=g(!1),V=new we({html:!0,linkify:!0,typographer:!0,breaks:!0,highlight:function(o,n){if(n&&re.getLanguage(n))try{const d=re.highlight(o,{language:n,ignoreIllegals:!0});return`<pre class="hljs"><code class="hljs language-${n}">${d.value}</code></pre>`}catch{}return`<pre class="hljs"><code class="hljs">${V.utils.escapeHtml(o)}</code></pre>`}}),D=new qe({headingStyle:"atx",codeBlockStyle:"fenced"}),j=g({Authorization:`Bearer ${localStorage.getItem("userToken")||localStorage.getItem("adminToken")}`}),M=g({theme:"snow",placeholder:p.placeholder,modules:{toolbar:{container:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{size:["small",!1,"large","huge"]}],["bold","italic","underline","strike"],[{color:[]},{background:[]}],[{script:"sub"},{script:"super"}],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{align:[]}],["link","image","video","formula"],["code-block"],["clean"]],handlers:{image:W}},history:{delay:1e3,maxStack:50,userOnly:!1}}}),z=se(()=>V.render(w.value)),G=se(()=>q.value==="markdown"?`å¼€å§‹ç”¨Markdownå†™ä½œå§...

ğŸ’¡ ä»£ç é«˜äº®ä½¿ç”¨æ–¹æ³•ï¼š
ä½¿ç”¨ä¸‰ä¸ªåå¼•å· \`\`\` åŒ…å›´ä»£ç ï¼Œå¹¶åœ¨å¼€å¤´æŒ‡å®šè¯­è¨€åç§°

ç¤ºä¾‹ï¼š
\`\`\`javascript
function hello() {
  console.log("Hello World!");
}
\`\`\`

\`\`\`python
def hello():
    print("Hello World!")
\`\`\`

\`\`\`java
public class Hello {
    public static void main(String[] args) {
        System.out.println("Hello World!");
    }
}
\`\`\`

æ”¯æŒçš„è¯­è¨€ï¼šjavascript, python, java, html, css, sql, json, xml ç­‰

å…¶ä»–è¯­æ³•ï¼š
# æ ‡é¢˜
**ç²—ä½“** *æ–œä½“*
- åˆ—è¡¨é¡¹
[é“¾æ¥æ–‡å­—](ç½‘å€)
![å›¾ç‰‡æè¿°](å›¾ç‰‡é“¾æ¥)`:p.placeholder||"å¼€å§‹å†™ä½œå§...");le(()=>p.modelValue,o=>{o!==m.value&&(m.value=o,q.value==="markdown"&&o&&(w.value=D.turndown(o)),q.value==="rich"&&L(()=>{setTimeout(()=>{a()},50)}))});const K=o=>{m.value=o,h("update:modelValue",o),L(()=>{setTimeout(()=>{a()},50)})},J=()=>{const o=V.render(w.value);m.value=o,h("update:modelValue",o)},N=o=>{if(o==="markdown")m.value&&(w.value=D.turndown(m.value)),y.value=!1;else{if(w.value){const n=V.render(w.value);m.value=n,h("update:modelValue",n)}L(()=>{setTimeout(()=>{a()},100)})}},B=()=>{y.value=!y.value};function W(){const o=document.createElement("input");o.setAttribute("type","file"),o.setAttribute("accept","image/*"),o.click(),o.onchange=()=>{const n=o.files[0];n&&Q(n)}}const Q=async o=>{if(!P(o))return;const n=new FormData;n.append("file",o);try{const b=await(await fetch("/api/upload/article-image",{method:"POST",headers:j.value,body:n})).json();if(b.success){let _=b.url;_&&_.startsWith("/")&&(_=`http://localhost:8080${_}`),E(_),h("image-uploaded",_),u.success("å›¾ç‰‡ä¸Šä¼ æˆåŠŸ")}else u.error("å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼š"+b.message)}catch(d){console.error("å›¾ç‰‡ä¸Šä¼ é”™è¯¯ï¼š",d),u.error("å›¾ç‰‡ä¸Šä¼ å¤±è´¥")}},E=o=>{const n=$.value.getQuill(),d=n.getSelection(),b=d?d.index:n.getLength();n.insertEmbed(b,"image",o),n.setSelection(b+1)},R=o=>{if(console.log("Upload response:",o),o&&o.success&&o.url){let n=o.url;if(n.startsWith("/")&&(n=`http://localhost:8080${n}`),console.log("Final image URL:",n),h("image-uploaded",n),q.value==="markdown"){const d=`![å›¾ç‰‡](${n})`,b=document.querySelector(".markdown-textarea textarea");if(b){const _=b.selectionStart,A=b.selectionEnd,I=w.value;w.value=I.substring(0,_)+d+I.substring(A),L(()=>{b.focus(),b.setSelectionRange(_+d.length,_+d.length)}),J()}}else E(n);u.success("å›¾ç‰‡ä¸Šä¼ æˆåŠŸ")}else{console.error("Invalid response structure:",o);const n=o&&o.message?o.message:"å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œå“åº”æ ¼å¼é”™è¯¯";u.error("å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼š"+n)}},P=o=>{const n=o.type.startsWith("image/"),d=o.size/1024/1024<5;return n?d?!0:(u.error("å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡ 5MBï¼"),!1):(u.error("åªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶ï¼"),!1)},F=()=>{var o;return(o=$.value)==null?void 0:o.getQuill()},X=()=>{const o=F();return o?o.getText():""},e=o=>{m.value=o},l=()=>{m.value=""},a=()=>{const o=document.querySelector(".ql-toolbar");if(!o)return;Object.entries({'.ql-header[value="1"]':"æ ‡é¢˜ 1",'.ql-header[value="2"]':"æ ‡é¢˜ 2",'.ql-header[value="3"]':"æ ‡é¢˜ 3",'.ql-header[value="4"]':"æ ‡é¢˜ 4",'.ql-header[value="5"]':"æ ‡é¢˜ 5",'.ql-header[value="6"]':"æ ‡é¢˜ 6",'.ql-header[value="false"]':"æ­£æ–‡",".ql-bold":"ç²—ä½“",".ql-italic":"æ–œä½“",".ql-underline":"ä¸‹åˆ’çº¿",".ql-strike":"åˆ é™¤çº¿",".ql-color":"æ–‡å­—é¢œè‰²",".ql-background":"èƒŒæ™¯é¢œè‰²",'.ql-script[value="sub"]':"ä¸‹æ ‡",'.ql-script[value="super"]':"ä¸Šæ ‡",'.ql-list[value="ordered"]':"æœ‰åºåˆ—è¡¨",'.ql-list[value="bullet"]':"æ— åºåˆ—è¡¨",'.ql-indent[value="-1"]':"å‡å°‘ç¼©è¿›",'.ql-indent[value="+1"]':"å¢åŠ ç¼©è¿›",'.ql-direction[value="rtl"]':"ä»å³åˆ°å·¦",'.ql-align[value=""]':"å·¦å¯¹é½",'.ql-align[value="center"]':"å±…ä¸­å¯¹é½",'.ql-align[value="right"]':"å³å¯¹é½",'.ql-align[value="justify"]':"ä¸¤ç«¯å¯¹é½",".ql-link":"æ’å…¥é“¾æ¥",".ql-image":"æ’å…¥å›¾ç‰‡",".ql-video":"æ’å…¥è§†é¢‘",".ql-formula":"æ’å…¥å…¬å¼",".ql-code-block":"ä»£ç å—",".ql-clean":"æ¸…é™¤æ ¼å¼",'.ql-size[value="small"]':"å°å·å­—ä½“",'.ql-size[value="large"]':"å¤§å·å­—ä½“",'.ql-size[value="huge"]':"è¶…å¤§å­—ä½“",'.ql-size[value="false"]':"æ­£å¸¸å­—ä½“"}).forEach(([x,Z])=>{const ae=o.querySelector(x);ae&&(ae.setAttribute("title",Z),ae.style.cursor="pointer")});const d=o.querySelector(".ql-header .ql-picker-label");d&&d.setAttribute("title","é€‰æ‹©æ ‡é¢˜çº§åˆ«");const b=o.querySelector(".ql-font .ql-picker-label");b&&b.setAttribute("title","é€‰æ‹©å­—ä½“");const _=o.querySelector(".ql-size .ql-picker-label");_&&_.setAttribute("title","é€‰æ‹©å­—ä½“å¤§å°");const A=o.querySelector(".ql-color .ql-picker-label");A&&A.setAttribute("title","é€‰æ‹©æ–‡å­—é¢œè‰²");const I=o.querySelector(".ql-background .ql-picker-label");I&&I.setAttribute("title","é€‰æ‹©èƒŒæ™¯é¢œè‰²");const r=o.querySelector(".ql-align .ql-picker-label");r&&r.setAttribute("title","é€‰æ‹©å¯¹é½æ–¹å¼")};return ie(()=>{L(()=>{setTimeout(()=>{a()},100)})}),k({getQuillInstance:F,getTextContent:X,setContent:e,clearContent:l}),(o,n)=>{const d=C("el-radio-button"),b=C("el-radio-group"),_=C("el-icon"),A=C("el-button"),I=C("el-upload"),r=C("el-input");return f(),T("div",Te,[i("div",Ce,[i("div",xe,[c(b,{modelValue:q.value,"onUpdate:modelValue":n[0]||(n[0]=x=>q.value=x),size:"small",onChange:N},{default:v(()=>[c(d,{value:"rich"},{default:v(()=>n[3]||(n[3]=[S("å¯Œæ–‡æœ¬")])),_:1,__:[3]}),c(d,{value:"markdown"},{default:v(()=>n[4]||(n[4]=[S("Markdown")])),_:1,__:[4]})]),_:1},8,["modelValue"])]),i("div",Ve,[c(I,{action:"/api/upload/article-image","show-file-list":!1,"on-success":R,"before-upload":P,headers:j.value,accept:"image/*",class:"image-upload-btn"},{default:v(()=>[c(A,{size:"small",type:"primary",plain:""},{default:v(()=>[c(_,null,{default:v(()=>[c(oe(he))]),_:1}),n[5]||(n[5]=S(" æ’å…¥å›¾ç‰‡ "))]),_:1,__:[5]})]),_:1},8,["headers"]),q.value==="markdown"?(f(),U(A,{key:0,size:"small",onClick:B,type:y.value?"primary":"default"},{default:v(()=>[c(_,null,{default:v(()=>[c(oe(ye))]),_:1}),S(" "+O(y.value?"éšè—é¢„è§ˆ":"é¢„è§ˆ"),1)]),_:1},8,["type"])):Y("",!0)])]),q.value==="rich"?(f(),U(oe(Se),{key:0,ref_key:"quillEditor",ref:$,content:m.value,"onUpdate:content":[n[1]||(n[1]=x=>m.value=x),K],options:M.value,"content-type":"html",class:"quill-editor"},null,8,["content","options"])):(f(),T("div",Ae,[i("div",{class:de(["markdown-editor-wrapper",{"split-view":y.value}])},[i("div",Ie,[c(r,{modelValue:w.value,"onUpdate:modelValue":n[2]||(n[2]=x=>w.value=x),type:"textarea",rows:20,placeholder:G.value,onInput:J,class:"markdown-textarea"},null,8,["modelValue","placeholder"])]),y.value?(f(),T("div",$e,[n[6]||(n[6]=i("div",{class:"preview-header"},[i("span",null,"é¢„è§ˆ")],-1)),i("div",{class:"preview-content",innerHTML:z.value},null,8,Me)])):Y("",!0)],2)]))])}}},je=ce(Oe,[["__scopeId","data-v-9d2fde18"]]),ze={class:"publish-page"},Be={class:"publish-header"},Ee={class:"header-content"},He={class:"header-left"},Le={class:"header-right"},Ue={class:"publish-main"},De={class:"publish-container"},Je={class:"editor-section"},Ne={class:"title-section"},We={class:"inspiration-section"},Qe={class:"inspiration-tags"},Re={class:"content-section"},Pe={class:"settings-section"},Fe={class:"setting-card"},Ge={key:0,class:"no-images"},Ke={key:1,class:"image-list"},Xe=["src"],Ye={class:"image-actions"},Ze={key:0,class:"cover-badge"},et={class:"setting-card"},tt={class:"setting-card"},lt={class:"setting-card"},ot={class:"setting-card"},at={class:"publish-options"},nt={class:"setting-card"},st={class:"preview-content"},it={class:"preview-title"},rt={class:"preview-meta"},ut={key:0},dt={key:0,class:"preview-summary"},ct=["innerHTML"],mt={__name:"Publish",setup(s){const k=fe(),t=g({title:"",content:"",summary:"",category:"",tags:[],images:[]}),p=g(!1),h=g(null),m=g(""),$=g("public"),q=g(!1),w=g(!1),y=g(!1),V=g(null),D=se(()=>`âœ¨ å¼€å§‹åˆ›ä½œæ‚¨çš„ç²¾å½©æ–‡ç« å§ï¼

ğŸ“ ç¼–è¾‘æŠ€å·§ï¼š
â€¢ ä½¿ç”¨é¡¶éƒ¨å·¥å…·æ è®¾ç½®æ–‡å­—æ ·å¼ï¼ˆç²—ä½“ã€æ–œä½“ã€é¢œè‰²ç­‰ï¼‰
â€¢ ğŸ“· ç‚¹å‡»å›¾ç‰‡å›¾æ ‡ä¸Šä¼ å¹¶æ’å…¥å›¾ç‰‡ï¼Œè®©æ–‡ç« æ›´ç”ŸåŠ¨
â€¢ ğŸ“‹ ä½¿ç”¨åˆ—è¡¨åŠŸèƒ½æ•´ç†è¦ç‚¹ï¼Œè®©å†…å®¹æ›´æ¸…æ™°
â€¢ ğŸ”— æ·»åŠ é“¾æ¥ä¸°å¯Œæ–‡ç« å†…å®¹
â€¢ ğŸ’» æ’å…¥ä»£ç å—åˆ†äº«æŠ€æœ¯ç»éªŒ
â€¢ ğŸ“Š ä½¿ç”¨æ ‡é¢˜åŠŸèƒ½æ„å»ºæ–‡ç« ç»“æ„

ğŸ’¡ å°è´´å£«ï¼šä¿æŒæ®µè½ç®€æ´ï¼Œé€‚å½“ä½¿ç”¨ç©ºè¡Œæå‡é˜…è¯»ä½“éªŒ`),j=g({Authorization:`Bearer ${localStorage.getItem("userToken")||localStorage.getItem("adminToken")}`}),M=g([]),z=g([]),G=g(["è®°å½•å·¥ä½œå®è·µã€é¡¹ç›®å¤ç›˜","å†™æŠ€æœ¯ç¬”è®°å’Œé—®é¢˜è§£å†³","å‘è¡¨è§‚ç‚¹å’Œå¿ƒå¾—","æ•´åˆæ—¥å¸¸ç¢ç‰‡åŒ–å­¦ä¹ å†…å®¹","åˆ†äº«å¼€å‘ç»éªŒå’ŒæŠ€å·§","æ€»ç»“å­¦ä¹ å¿ƒå¾—å’Œæ„Ÿæ‚Ÿ"]),K=()=>{k.go(-1)},J=e=>{t.value.content?t.value.content+=`

`+e:t.value.content=e},N=e=>{console.log("å›¾ç‰‡ä¸Šä¼ æˆåŠŸ:",e);const l=e.startsWith("http")?e:`http://localhost:8080${e}`;t.value.images.includes(l)||t.value.images.push(l),console.log("å›¾ç‰‡å·²æ·»åŠ åˆ°ç®¡ç†åˆ—è¡¨:",l)},B=e=>{m.value=e,u.success("å°é¢è®¾ç½®æˆåŠŸ")},W=async(e,l)=>{try{await _e.confirm("ç¡®å®šè¦åˆ é™¤è¿™å¼ å›¾ç‰‡å—ï¼Ÿåˆ é™¤åæ— æ³•æ¢å¤ã€‚","ç¡®è®¤åˆ é™¤",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"});const a=await H.delete("/api/upload/delete",{params:{url:e},headers:{Authorization:`Bearer ${localStorage.getItem("userToken")||localStorage.getItem("adminToken")}`}});if(a.data.success){e===m.value&&(m.value="",u.info("å·²æ¸…é™¤å°é¢è®¾ç½®")),t.value.images.splice(l,1);const o=`![å›¾ç‰‡æè¿°](${e})`;t.value.content=t.value.content.replace(o,""),u.success("å›¾ç‰‡åˆ é™¤æˆåŠŸ")}else u.error(a.data.message||"åˆ é™¤å¤±è´¥")}catch(a){a!=="cancel"&&(console.error("åˆ é™¤å›¾ç‰‡å¤±è´¥:",a),u.error("åˆ é™¤å¤±è´¥ï¼Œè¯·é‡è¯•"))}},Q=async e=>{try{await navigator.clipboard.writeText(e),u.success("å›¾ç‰‡é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch{const a=document.createElement("textarea");a.value=e,document.body.appendChild(a),a.select(),document.execCommand("copy"),document.body.removeChild(a),u.success("å›¾ç‰‡é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}},E=async()=>{var e,l;if(!t.value.title.trim()){u.warning("è¯·è¾“å…¥æ–‡ç« æ ‡é¢˜");return}w.value=!0;try{const a=localStorage.getItem("userToken")||localStorage.getItem("adminToken"),o={...t.value,images:JSON.stringify(t.value.images),tags:JSON.stringify(t.value.tags),status:"DRAFT"};p.value||(o.viewCount=0,o.likeCount=0),console.log(p.value?"æ›´æ–°è‰ç¨¿æ•°æ®:":"ä¿å­˜è‰ç¨¿æ•°æ®:",o);let n;p.value&&h.value?(n=await H.put(`/api/blogs/${h.value}`,o,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}}),u.success("è‰ç¨¿æ›´æ–°æˆåŠŸï¼")):(n=await H.post("/api/blogs",o,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}}),u.success("è‰ç¨¿ä¿å­˜æˆåŠŸï¼"))}catch(a){console.error(p.value?"æ›´æ–°è‰ç¨¿å¤±è´¥:":"ä¿å­˜è‰ç¨¿å¤±è´¥:",a);const o=((l=(e=a.response)==null?void 0:e.data)==null?void 0:l.message)||a.message;u.error((p.value?"æ›´æ–°å¤±è´¥ï¼š":"ä¿å­˜å¤±è´¥ï¼š")+o)}finally{w.value=!1}},R=async()=>{var e,l;if(!t.value.title.trim()){u.warning("è¯·è¾“å…¥æ–‡ç« æ ‡é¢˜");return}if(t.value.title.length<5||t.value.title.length>100){u.warning("æ–‡ç« æ ‡é¢˜é•¿åº¦åº”åœ¨5-100ä¸ªå­—ç¬¦ä¹‹é—´");return}if(!t.value.content.trim()){u.warning("è¯·è¾“å…¥æ–‡ç« å†…å®¹");return}if(!t.value.category){u.warning("è¯·é€‰æ‹©æ–‡ç« åˆ†ç±»");return}y.value=!0;try{const a=localStorage.getItem("userToken")||localStorage.getItem("adminToken"),o={...t.value,images:JSON.stringify(t.value.images),tags:JSON.stringify(t.value.tags),status:"PUBLISHED"};p.value||(o.viewCount=0,o.likeCount=0),console.log(p.value?"æ›´æ–°æ–‡ç« æ•°æ®:":"å‘å¸ƒæ–‡ç« æ•°æ®:",o);let n;p.value&&h.value?(n=await H.put(`/api/blogs/${h.value}`,o,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}}),u.success("æ–‡ç« æ›´æ–°æˆåŠŸï¼")):(n=await H.post("/api/blogs",o,{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}}),u.success("æ–‡ç« å‘å¸ƒæˆåŠŸï¼")),n.data&&k.push("/articles")}catch(a){console.error(p.value?"æ›´æ–°æ–‡ç« å¤±è´¥:":"å‘å¸ƒæ–‡ç« å¤±è´¥:",a);const o=((l=(e=a.response)==null?void 0:e.data)==null?void 0:l.message)||a.message;u.error((p.value?"æ›´æ–°å¤±è´¥ï¼š":"å‘å¸ƒå¤±è´¥ï¼š")+o)}finally{y.value=!1}},P=()=>{q.value=!0},F=async()=>{try{const e=await H.get("/api/categories");e.data&&Array.isArray(e.data)?M.value=e.data:M.value=[{id:1,name:"æŠ€æœ¯åˆ†äº«"},{id:2,name:"ç”Ÿæ´»éšç¬”"},{id:3,name:"å­¦ä¹ ç¬”è®°"},{id:4,name:"é¡¹ç›®ç»éªŒ"}]}catch(e){console.error("è·å–åˆ†ç±»å¤±è´¥:",e),M.value=[{id:1,name:"æŠ€æœ¯åˆ†äº«"},{id:2,name:"ç”Ÿæ´»éšç¬”"},{id:3,name:"å­¦ä¹ ç¬”è®°"},{id:4,name:"é¡¹ç›®ç»éªŒ"}]}},X=async()=>{try{const e=await H.get("/api/tags/active");e.data&&(z.value=e.data)}catch(e){console.error("è·å–æ ‡ç­¾å¤±è´¥:",e),z.value=[{id:1,name:"Vue.js",isActive:!0},{id:2,name:"Spring Boot",isActive:!0},{id:3,name:"JavaScript",isActive:!0},{id:4,name:"Java",isActive:!0},{id:5,name:"MySQL",isActive:!0},{id:6,name:"å‰ç«¯å¼€å‘",isActive:!0},{id:7,name:"åç«¯å¼€å‘",isActive:!0}]}};return ie(()=>{const e=localStorage.getItem("userToken")||localStorage.getItem("adminToken");j.value={Authorization:`Bearer ${e}`},F(),X();const l=sessionStorage.getItem("editingBlog");if(l)try{const a=JSON.parse(l);p.value=!0,h.value=a.id,t.value={title:a.title||"",content:a.content||"",summary:a.summary||"",category:a.category||"",tags:a.tags?typeof a.tags=="string"?a.tags.startsWith("[")&&a.tags.endsWith("]")?JSON.parse(a.tags):a.tags.split(",").filter(o=>o.trim()):a.tags:[],images:a.images?typeof a.images=="string"?JSON.parse(a.images):a.images:[]},t.value.images.length>0&&(m.value=t.value.images[0]),sessionStorage.removeItem("editingBlog"),u.success("å·²åŠ è½½æ–‡ç« æ•°æ®ï¼Œå¯ä»¥ç»§ç»­ç¼–è¾‘")}catch(a){console.error("è§£æç¼–è¾‘æ•°æ®å¤±è´¥:",a),u.error("åŠ è½½ç¼–è¾‘æ•°æ®å¤±è´¥")}}),(e,l)=>{const a=C("el-button"),o=C("el-input"),n=C("el-tag"),d=C("el-option"),b=C("el-select"),_=C("el-radio"),A=C("el-radio-group"),I=C("el-dialog");return f(),T("div",ze,[i("header",Be,[i("div",Ee,[i("div",He,[c(a,{onClick:K,icon:oe(be),circle:"",size:"large"},null,8,["icon"]),i("h1",null,O(p.value?"ç¼–è¾‘æ–‡ç« ":"å‘å¸ƒæ–‡ç« "),1)]),i("div",Le,[c(a,{onClick:E,loading:w.value},{default:v(()=>l[7]||(l[7]=[S("ä¿å­˜è‰ç¨¿")])),_:1,__:[7]},8,["loading"]),c(a,{type:"primary",onClick:R,loading:y.value},{default:v(()=>[S(O(p.value?"æ›´æ–°æ–‡ç« ":"å‘å¸ƒæ–‡ç« "),1)]),_:1},8,["loading"])])])]),i("main",Ue,[i("div",De,[i("div",Je,[i("div",Ne,[c(o,{modelValue:t.value.title,"onUpdate:modelValue":l[0]||(l[0]=r=>t.value.title=r),placeholder:"è¯·è¾“å…¥æ–‡ç« æ ‡é¢˜ï¼ˆ5-100ä¸ªå­—ï¼‰",size:"large",maxlength:"100","show-word-limit":"",class:"title-input"},null,8,["modelValue"])]),i("div",We,[l[8]||(l[8]=i("h3",null,"ğŸ’¡ åˆ›ä½œçµæ„Ÿ",-1)),i("div",Qe,[(f(!0),T(ee,null,te(G.value,r=>(f(),U(n,{key:r,onClick:x=>J(r),class:"inspiration-tag"},{default:v(()=>[S(O(r),1)]),_:2},1032,["onClick"]))),128))])]),i("div",Re,[c(je,{modelValue:t.value.content,"onUpdate:modelValue":l[1]||(l[1]=r=>t.value.content=r),placeholder:D.value,height:"500px",onImageUploaded:N,ref_key:"richTextEditor",ref:V},null,8,["modelValue","placeholder"])])]),i("div",Pe,[i("div",Fe,[l[14]||(l[14]=i("h3",null,"ğŸ–¼ï¸ å›¾ç‰‡ç®¡ç†",-1)),t.value.images.length===0?(f(),T("div",Ge,l[9]||(l[9]=[i("p",null,"æš‚æ— ä¸Šä¼ çš„å›¾ç‰‡",-1),i("p",{class:"upload-hint"},"åœ¨ç¼–è¾‘å™¨ä¸­ç‚¹å‡»å›¾ç‰‡æŒ‰é’®ä¸Šä¼ å›¾ç‰‡",-1)]))):(f(),T("div",Ke,[(f(!0),T(ee,null,te(t.value.images,(r,x)=>(f(),T("div",{key:x,class:de(["image-item",{"is-cover":r===m.value}])},[i("img",{src:r,class:"thumbnail"},null,8,Xe),i("div",Ye,[r!==m.value?(f(),U(a,{key:0,size:"small",type:"success",plain:"",onClick:Z=>B(r)},{default:v(()=>l[10]||(l[10]=[S(" è®¾ä¸ºå°é¢ ")])),_:2,__:[10]},1032,["onClick"])):(f(),U(a,{key:1,size:"small",type:"success",disabled:""},{default:v(()=>l[11]||(l[11]=[S(" å½“å‰å°é¢ ")])),_:1,__:[11]})),c(a,{size:"small",type:"primary",plain:"",onClick:Z=>Q(r)},{default:v(()=>l[12]||(l[12]=[S(" å¤åˆ¶é“¾æ¥ ")])),_:2,__:[12]},1032,["onClick"]),c(a,{size:"small",type:"danger",plain:"",onClick:Z=>W(r,x)},{default:v(()=>l[13]||(l[13]=[S(" åˆ é™¤ ")])),_:2,__:[13]},1032,["onClick"])]),r===m.value?(f(),T("div",Ze," ğŸ“· å°é¢ ")):Y("",!0)],2))),128))]))]),i("div",et,[l[15]||(l[15]=i("h3",null,"ğŸ“ æ–‡ç« æ‘˜è¦",-1)),c(o,{modelValue:t.value.summary,"onUpdate:modelValue":l[2]||(l[2]=r=>t.value.summary=r),type:"textarea",placeholder:"è¯·è¾“å…¥æ–‡ç« æ‘˜è¦ï¼ˆå¯é€‰ï¼‰",rows:3,maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),i("div",tt,[l[16]||(l[16]=i("h3",null,"ğŸ“‚ é€‰æ‹©åˆ†ç±»",-1)),c(b,{modelValue:t.value.category,"onUpdate:modelValue":l[3]||(l[3]=r=>t.value.category=r),placeholder:"è¯·é€‰æ‹©åˆ†ç±»",style:{width:"100%"}},{default:v(()=>[(f(!0),T(ee,null,te(M.value,r=>(f(),U(d,{key:r.id,label:r.name,value:r.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),i("div",lt,[l[17]||(l[17]=i("h3",null,"ğŸ·ï¸ æ·»åŠ æ ‡ç­¾",-1)),c(b,{modelValue:t.value.tags,"onUpdate:modelValue":l[4]||(l[4]=r=>t.value.tags=r),multiple:"",filterable:"","allow-create":"",placeholder:"é€‰æ‹©æˆ–åˆ›å»ºæ ‡ç­¾",style:{width:"100%"}},{default:v(()=>[(f(!0),T(ee,null,te(z.value,r=>(f(),U(d,{key:r.id,label:r.name,value:r.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),i("div",ot,[l[20]||(l[20]=i("h3",null,"âš™ï¸ å‘å¸ƒè®¾ç½®",-1)),i("div",at,[c(A,{modelValue:$.value,"onUpdate:modelValue":l[5]||(l[5]=r=>$.value=r),class:"publish-type"},{default:v(()=>[c(_,{label:"public"},{default:v(()=>l[18]||(l[18]=[S("å…¨éƒ¨å¯è§")])),_:1,__:[18]}),c(_,{label:"private"},{default:v(()=>l[19]||(l[19]=[S("ä»…è‡ªå·±å¯è§")])),_:1,__:[19]})]),_:1},8,["modelValue"])])]),i("div",nt,[c(a,{onClick:P,style:{width:"100%"},size:"large"},{default:v(()=>l[21]||(l[21]=[S(" ğŸ‘€ é¢„è§ˆæ–‡ç«  ")])),_:1,__:[21]})])])])]),c(I,{modelValue:q.value,"onUpdate:modelValue":l[6]||(l[6]=r=>q.value=r),title:"æ–‡ç« é¢„è§ˆ",width:"80%",class:"preview-dialog"},{default:v(()=>[i("div",st,[i("h1",it,O(t.value.title||"æœªè®¾ç½®æ ‡é¢˜"),1),i("div",rt,[i("span",null,"åˆ†ç±»ï¼š"+O(t.value.category||"æœªåˆ†ç±»"),1),t.value.tags.length?(f(),T("span",ut,"æ ‡ç­¾ï¼š"+O(t.value.tags.join(", ")),1)):Y("",!0)]),t.value.summary?(f(),T("div",dt,[l[22]||(l[22]=i("strong",null,"æ‘˜è¦ï¼š",-1)),S(O(t.value.summary),1)])):Y("",!0),i("div",{class:"preview-body",innerHTML:t.value.content||"æš‚æ— å†…å®¹"},null,8,ct)])]),_:1},8,["modelValue"])])}}},yt=ce(mt,[["__scopeId","data-v-3e8a09d1"]]);export{yt as default};
