import{m as q,ax as I,aw as J,c as r,o,a as n,I as L,P as a,ag as i,J as c,L as d,M as l,O as y,a6 as f,H as u,aq as O,G as S}from"./vendor-qcSz3H5x.js";import{_ as R}from"./index-CbgkKY63.js";import"./elementPlus-Cz6C--fH.js";const T={class:"search-redirect"},W={class:"loading-container"},$={class:"search-results"},M={class:"container"},j={key:0,class:"search-stats"},E={key:0},G={key:1},H={key:2},Q={key:3},X={key:1,class:"loading"},Y={key:2,class:"blog-list"},Z=["onClick"],b={class:"blog-content"},x={key:0,class:"blog-image"},ee=["src","alt"],te={class:"blog-title"},se={class:"blog-summary"},oe={class:"blog-meta"},re={class:"author"},ne={class:"date"},ae={key:0,class:"category"},ie={class:"views"},le={class:"likes"},ce={key:1,class:"blog-tags"},de={key:3,class:"no-results"},ue={key:4,class:"search-suggestions"},_e={class:"suggestion-tags"},pe={key:5,class:"pagination"},he={__name:"Search",setup(ge){const w=J(),z=I();q(()=>{const e={...z.query};w.replace({path:"/articles",query:e})});const k=e=>{if(console.log("获取搜索博客图片:",e.id,e.images),!e.images)return console.log("搜索博客无images字段:",e.id),null;try{const t=typeof e.images=="string"?JSON.parse(e.images):e.images;if(console.log("解析后的images:",t),Array.isArray(t)&&t.length>0){const _=t[0],h=_.startsWith("http")?_:`http://localhost:8080${_}`;return console.log("返回图片URL:",h),h}}catch(t){console.error("解析图片数据失败:",t,e.images)}return null},v=e=>{if(!e)return[];try{if(typeof e=="string"){if(e.startsWith("[")&&e.endsWith("]")){const t=JSON.parse(e);return Array.isArray(t)?t.filter(_=>_&&_.trim()):[]}return e.split(",").map(t=>t.trim()).filter(t=>t)}if(Array.isArray(e))return e.filter(t=>t&&t.trim())}catch(t){console.error("解析标签数据失败:",t)}return[]};return(e,t)=>{const _=i("el-loading-directive"),h=i("el-skeleton"),F=i("User"),p=i("el-icon"),A=i("Calendar"),N=i("Folder"),P=i("View"),U=i("Star"),C=i("el-tag"),K=i("el-button"),V=i("el-empty"),B=i("el-pagination"),D=O("loading");return o(),r("div",T,[n("div",W,[L(a(_,{text:"正在跳转到文章页面..."},null,512),[[D,!0]])]),n("div",$,[n("div",M,[e.searchPerformed||!e.searchKeyword&&!e.categoryFilter?(o(),r("div",j,[n("p",null,[e.searchKeyword?(o(),r("span",E,'搜索 "'+l(e.searchKeyword)+'"',1)):c("",!0),e.categoryFilter?(o(),r("span",G,' 在分类 "'+l(e.categoryFilter)+'" 中',1)):c("",!0),!e.searchKeyword&&!e.categoryFilter?(o(),r("span",H,"共有")):c("",!0),e.searchKeyword||e.categoryFilter?(o(),r("span",Q,"找到")):c("",!0),d(" "+l(e.total)+" 篇文章 ",1)])])):c("",!0),e.loading?(o(),r("div",X,[a(h,{rows:3,animated:""})])):e.blogs.length>0?(o(),r("div",Y,[(o(!0),r(y,null,f(e.blogs,s=>{var g;return o(),r("div",{key:s.id,class:"blog-card",onClick:m=>e.goToBlogDetail(s.id)},[n("div",b,[k(s)?(o(),r("div",x,[n("img",{src:k(s),alt:s.title},null,8,ee)])):c("",!0),n("h3",te,l(s.title),1),n("p",se,l(s.summary||((g=s.content)==null?void 0:g.substring(0,150))+"..."),1),n("div",oe,[n("span",re,[a(p,null,{default:u(()=>[a(F)]),_:1}),d(" "+l(s.authorName),1)]),n("span",ne,[a(p,null,{default:u(()=>[a(A)]),_:1}),d(" "+l(e.formatDate(s.publishedAt||s.createdAt)),1)]),s.category?(o(),r("span",ae,[a(p,null,{default:u(()=>[a(N)]),_:1}),d(" "+l(s.category),1)])):c("",!0),n("span",ie,[a(p,null,{default:u(()=>[a(P)]),_:1}),d(" "+l(s.viewCount||0),1)]),n("span",le,[a(p,null,{default:u(()=>[a(U)]),_:1}),d(" "+l(s.likeCount||0),1)])]),s.tags&&v(s.tags).length>0?(o(),r("div",ce,[(o(!0),r(y,null,f(v(s.tags),m=>(o(),S(C,{key:m,size:"small",class:"tag"},{default:u(()=>[d(l(m.trim()),1)]),_:2},1024))),128))])):c("",!0)])],8,Z)}),128))])):e.searchPerformed?(o(),r("div",de,[a(V,{description:"没有找到相关文章"},{default:u(()=>[a(K,{type:"primary",onClick:e.clearSearch},{default:u(()=>t[2]||(t[2]=[d("清空搜索")])),_:1,__:[2]},8,["onClick"])]),_:1})])):!e.searchPerformed&&e.searchKeyword.trim()===""&&e.categoryFilter===""&&e.blogs.length===0?(o(),r("div",ue,[t[3]||(t[3]=n("h3",null,"搜索建议",-1)),n("div",_e,[(o(!0),r(y,null,f(e.searchSuggestions,s=>(o(),S(C,{key:s,class:"suggestion-tag",onClick:g=>e.searchSuggestion(s)},{default:u(()=>[d(l(s),1)]),_:2},1032,["onClick"]))),128))])])):c("",!0),e.total>e.pageSize?(o(),r("div",pe,[a(B,{"current-page":e.currentPage,"onUpdate:currentPage":t[0]||(t[0]=s=>e.currentPage=s),"page-size":e.pageSize,"onUpdate:pageSize":t[1]||(t[1]=s=>e.pageSize=s),"page-sizes":[10,20,50],total:e.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])):c("",!0)])])])}}},ke=R(he,[["__scopeId","data-v-f4997d7d"]]);export{ke as default};
